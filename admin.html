<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel de Administraci√≥n - Humads</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #f5f6fa;
            margin: 0;
            padding: 0;
            min-height: 100vh;
        }

        .admin-container {
            min-height: 100vh;
            margin: 0;
            background: white;
            border-radius: 0;
            box-shadow: none;
            display: flex;
            flex-direction: column;
        }

        .admin-header {
            background: white;
            color: #1E0A5E;
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #e0e0e0;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .admin-header h1 {
            font-size: 24px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 600;
        }

        .admin-header h1 i {
            color: #6a00f4;
        }

        .header-actions {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .btn-preview-fixed {
            background: #6a00f4;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 2px 8px rgba(106, 0, 244, 0.2);
        }

        .btn-preview-fixed:hover {
            background: #5a00d4;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(106, 0, 244, 0.3);
        }

        .btn-view-site {
            background: #f8f9fa;
            color: #6a00f4;
            padding: 12px 20px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            border: 1px solid #e0e0e0;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }

        .btn-view-site:hover {
            background: #6a00f4;
            color: white;
            transform: translateY(-1px);
        }

        .admin-nav {
            background: white;
            padding: 0 30px;
            border-bottom: 1px solid #e0e0e0;
        }

        .nav-tabs {
            display: flex;
            list-style: none;
            padding: 0;
            margin: 0;
            gap: 8px;
        }

        .nav-tab {
            padding: 16px 24px;
            cursor: pointer;
            background: none;
            border: none;
            font-size: 14px;
            font-weight: 500;
            color: #666;
            border-radius: 8px 8px 0 0;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-tab:hover {
            background: #f8f9fa;
            color: #6a00f4;
        }

        .nav-tab.active {
            color: #6a00f4;
            background: #f8f9fa;
            border-bottom: 2px solid #6a00f4;
        }

        .nav-tab i {
            font-size: 16px;
        }

        .admin-main {
            flex: 1;
        }

        .admin-content {
            width: 100%;
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px 80px;
        }

        .preview-header {
            background: white;
            padding: 20px;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .preview-content {
            flex: 1;
            overflow-y: auto;
            background: white;
            margin: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .preview-section {
            padding: 30px;
            border-bottom: 1px solid #f0f0f0;
        }

        .preview-section:last-child {
            border-bottom: none;
        }

        .section-label {
            background: #6a00f4;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 15px;
            display: inline-block;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
            min-height: auto;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .form-section {
            margin-bottom: 50px;
            padding: 0;
            background: white;
            border-radius: 15px;
            border: 1px solid #e0e0e0;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }

        .form-section:hover {
            box-shadow: 0 4px 20px rgba(106, 0, 244, 0.1);
            border-color: #d0d0d0;
        }

        .form-section-header {
            background: #6a00f4;
            color: white;
            padding: 20px 30px;
            margin: 0;
        }

        .form-section-header h3 {
            color: white;
            margin: 0;
            font-size: 18px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .form-section-content {
            padding: 40px;
        }

        .form-group {
            margin-bottom: 32px;
        }

        .form-group label {
            display: block;
            margin-bottom: 12px;
            color: #1E0A5E;
            font-weight: 600;
            font-size: 15px;
        }

        .form-control {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid #e8eaed;
            border-radius: 12px;
            font-size: 15px;
            transition: all 0.3s ease;
            background: white;
            font-family: 'Inter', sans-serif;
        }

        .form-control:focus {
            outline: none;
            border-color: #6a00f4;
            box-shadow: 0 0 0 4px rgba(106, 0, 244, 0.1);
            background: #fdfdfd;
        }

        .form-control::placeholder {
            color: #9aa0a6;
            font-style: italic;
        }

        textarea.form-control {
            resize: vertical;
            min-height: 120px;
            line-height: 1.6;
        }

        .form-help-text {
            font-size: 13px;
            color: #6c757d;
            margin-top: 10px;
            font-style: italic;
            line-height: 1.5;
            padding: 8px 12px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 3px solid #6a00f4;
        }

        .dynamic-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 15px;
        }

        .dynamic-item {
            display: flex;
            gap: 12px;
            align-items: center;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 12px;
            border: 1px solid #e8eaed;
            transition: all 0.3s ease;
        }

        .dynamic-item:hover {
            box-shadow: 0 2px 8px rgba(106, 0, 244, 0.1);
            border-color: #6a00f4;
        }

        .dynamic-item input {
            flex: 1;
            margin-bottom: 0;
        }

        .btn-remove {
            background: #dc3545;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 12px;
        }

        .btn-remove:hover {
            background: #c82333;
        }

        .btn-add {
            background: #28a745;
            color: white;
            border: none;
            padding: 14px 24px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
            font-size: 15px;
            margin-top: 20px;
            box-shadow: 0 2px 8px rgba(40, 167, 69, 0.2);
        }

        .btn-add:hover {
            background: #218838;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
        }

        .team-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }

        .team-member-card {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            padding: 25px;
            transition: all 0.3s ease;
            margin-bottom: 20px;
        }

        .team-member-card:hover {
            box-shadow: 0 8px 25px rgba(106, 0, 244, 0.15);
            transform: translateY(-3px);
            border-color: #6a00f4;
        }

        .team-member-card .form-control {
            margin-bottom: 15px;
        }

        .image-upload {
            position: relative;
            width: 100%;
            height: 180px;
            background: #f8f9fa;
            border: 2px dashed #6a00f4;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            overflow: hidden;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .image-upload:hover {
            background: #f0f3ff;
            border-color: #5a00d4;
            transform: translateY(-2px);
        }

        .image-upload img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .image-upload-placeholder {
            text-align: center;
            color: #999;
        }

        .admin-actions {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin: 30px 0;
            padding: 30px 0;
            border-top: 1px solid #e0e0e0;
        }

        .btn-save {
            background: #6a00f4;
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .btn-save:hover {
            background: #5a00d4;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(106, 0, 244, 0.3);
        }

        .alert {
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: none;
        }

        .alert.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 50px;
        }

        .loading.active {
            display: block;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #6a00f4;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Preview Mobile Mode */
        .preview-content.mobile-mode {
            max-width: 375px;
            margin: 20px auto;
        }

        .btn-secondary {
            background: white;
            color: #6a00f4;
            border: 2px solid #6a00f4;
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .btn-secondary:hover {
            background: #6a00f4;
            color: white;
        }

        /* Import landing page styles for preview */
        .preview-content {
            font-family: 'Inter', sans-serif;
        }

        /* Hero styles from landing */
        .preview-hero {
            background: linear-gradient(135deg, #6A00F4, #00CFFF, #FF00A8);
            padding: 4rem 2rem;
            position: relative;
            overflow: hidden;
        }

        .preview-hero-content {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 4rem;
            align-items: center;
        }

        .preview-hero-text h1 {
            font-size: 4rem;
            font-weight: 700;
            color: white;
            line-height: 1.1;
            margin-bottom: 1.5rem;
        }

        .preview-hero .dynamic-text {
            background: linear-gradient(90deg, #00CFFF, #FF00A8);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: glow 2s ease-in-out infinite alternate;
        }

        .preview-hero-text p {
            font-size: 1.2rem;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 2rem;
            line-height: 1.6;
        }

        .preview-hero-buttons {
            display: flex;
            gap: 1rem;
            margin-bottom: 3rem;
            flex-wrap: wrap;
        }

        .preview-btn-primary, .preview-btn-secondary {
            padding: 1rem 2rem;
            border-radius: 12px;
            font-weight: 600;
            font-size: 1rem;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .preview-btn-primary {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .preview-btn-secondary {
            background: transparent;
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.5);
        }

        .preview-hero-features {
            display: flex;
            gap: 2rem;
            flex-wrap: wrap;
        }

        .preview-feature {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: white;
            font-weight: 500;
        }

        .preview-feature i {
            color: #00CFFF;
            font-size: 1.2rem;
        }

        /* About styles from landing */
        .preview-about {
            padding: 6rem 2rem;
            background: white;
        }

        .preview-about-content {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 4rem;
            align-items: center;
        }

        .preview-section-label {
            background: linear-gradient(90deg, #6A00F4, #00CFFF);
            color: white;
            padding: 0.5rem 1.5rem;
            border-radius: 25px;
            font-size: 0.875rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            display: inline-block;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .preview-about h2 {
            font-size: 3rem;
            font-weight: 700;
            color: #1E0A5E;
            line-height: 1.2;
            margin-bottom: 3rem;
        }

        .preview-service-item {
            display: flex;
            gap: 1.5rem;
            margin-bottom: 2.5rem;
            padding: 2rem;
            background: rgba(106, 0, 244, 0.02);
            border-radius: 20px;
            border-left: 4px solid #6A00F4;
            transition: all 0.3s ease;
        }

        .preview-service-icon {
            background: linear-gradient(135deg, #6A00F4, #00CFFF);
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        .preview-service-content h4 {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1E0A5E;
            margin-bottom: 0.5rem;
        }

        .preview-service-content p {
            color: #666;
            line-height: 1.6;
        }

        /* Stats styles from landing */
        .preview-stats {
            padding: 6rem 2rem;
            background: linear-gradient(135deg, #f8f9ff 0%, #e6f3ff 100%);
        }

        .preview-stats-content {
            max-width: 1200px;
            margin: 0 auto;
            text-align: center;
        }

        .preview-stats h2 {
            font-size: 3rem;
            font-weight: 700;
            color: #1E0A5E;
            margin-bottom: 3rem;
        }

        .preview-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
        }

        .preview-stat-item {
            background: white;
            padding: 3rem 2rem;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(106, 0, 244, 0.1);
            transition: all 0.3s ease;
            border: 1px solid rgba(106, 0, 244, 0.1);
        }

        .preview-stat-value {
            font-size: 3rem;
            font-weight: 700;
            background: linear-gradient(135deg, #6A00F4, #00CFFF);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
        }

        .preview-stat-label {
            color: #666;
            font-weight: 500;
            font-size: 1.1rem;
        }

        /* Team styles from landing */
        .preview-team {
            padding: 6rem 2rem;
            background: white;
        }

        .preview-team-content {
            max-width: 1200px;
            margin: 0 auto;
            text-align: center;
        }

        .preview-team h2 {
            font-size: 3rem;
            font-weight: 700;
            color: #1E0A5E;
            margin-bottom: 3rem;
        }

        .preview-team-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 2rem;
        }

        .preview-team-member {
            background: rgba(106, 0, 244, 0.02);
            padding: 2rem;
            border-radius: 20px;
            transition: all 0.3s ease;
            border: 1px solid rgba(106, 0, 244, 0.1);
        }

        .preview-team-member:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(106, 0, 244, 0.15);
        }

        /* Team members grid container */
        #team-members {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        /* Responsive: single column on smaller screens */
        @media (max-width: 768px) {
            #team-members {
                grid-template-columns: 1fr;
            }
        }

        /* Team member cards in admin */
        .team-member-card {
            background: rgba(106, 0, 244, 0.02);
            border: 1px solid rgba(106, 0, 244, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 0; /* Remove bottom margin since grid handles spacing */
            transition: all 0.3s ease;
        }

        .team-member-card:hover {
            border-color: rgba(106, 0, 244, 0.3);
            box-shadow: 0 10px 25px rgba(106, 0, 244, 0.1);
        }

        .team-member-card .form-control {
            margin-bottom: 15px;
        }

        .preview-team-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            margin: 0 auto 1rem;
            border: 4px solid rgba(106, 0, 244, 0.1);
        }

        .preview-team-name {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1E0A5E;
            margin-bottom: 0.5rem;
        }

        .preview-team-role {
            color: #666;
            font-weight: 500;
        }

        @keyframes glow {
            from { filter: brightness(1); }
            to { filter: brightness(1.3); }
        }

        @media (max-width: 768px) {
            .admin-actions {
                flex-direction: column;
                align-items: center;
            }
            
            .btn-save, .btn-preview {
                width: 100%;
                max-width: 300px;
            }
        }

        /* Preview placeholder styles */
        .preview-placeholder {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            text-align: center;
            padding: 2rem;
            background: linear-gradient(135deg, #f8f9ff 0%, #e6f3ff 100%);
        }

        .preview-icon {
            font-size: 4rem;
            color: #6a00f4;
            margin-bottom: 1rem;
        }

        .preview-placeholder h4 {
            color: #1E0A5E;
            margin-bottom: 0.5rem;
            font-size: 1.5rem;
        }

        .preview-placeholder p {
            color: #666;
            margin-bottom: 2rem;
            font-size: 1rem;
        }

        .preview-tips {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            max-width: 300px;
        }

        .tip-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(106, 0, 244, 0.1);
        }

        .tip-item i {
            color: #6a00f4;
            font-size: 1.1rem;
        }

        .tip-item span {
            color: #1E0A5E;
            font-weight: 500;
            font-size: 0.9rem;
        }

        /* Preview Modal Styles */
        .preview-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0, 0, 0, 0.9);
            z-index: 10000;
            display: none;
            align-items: center;
            justify-content: center;
        }

        .preview-modal.active {
            display: flex;
        }

        .preview-modal-content {
            position: relative;
            width: 95vw;
            height: 95vh;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .preview-modal-header {
            background: #6a00f4;
            color: white;
            padding: 1rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .preview-modal-header h3 {
            margin: 0;
            font-size: 1.2rem;
        }

        .preview-modal-controls {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .modal-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
        }

        .modal-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .modal-close-btn {
            background: #ff4444;
            border: none;
            padding: 0.5rem;
            border-radius: 6px;
            cursor: pointer;
            color: white;
            font-size: 1.2rem;
            transition: all 0.3s ease;
        }

        .modal-close-btn:hover {
            background: #cc0000;
        }

        .preview-modal-iframe {
            width: 100%;
            height: calc(100% - 60px);
            border: none;
        }

        /* Mobile responsive for modal */
        @media (max-width: 768px) {
            .preview-modal-content {
                width: 98vw;
                height: 98vh;
            }
            
            .preview-modal-controls {
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .modal-btn {
                font-size: 0.8rem;
                padding: 0.4rem 0.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <div class="admin-header">
            <h1>
                <i class="fas fa-edit"></i>
                Panel de Administraci√≥n
            </h1>
            <div class="header-actions">
                <button class="btn-preview-fixed" onclick="openPreviewModal()">
                    <i class="fas fa-eye"></i> Vista Previa
                </button>
                <a href="index.html" class="btn-view-site" target="_blank">
                    <i class="fas fa-external-link-alt"></i> Ver Sitio
                </a>
            </div>
        </div>

        <nav class="admin-nav">
            <ul class="nav-tabs">
                <li class="nav-tab active" data-tab="hero">
                    <i class="fas fa-home"></i> Inicio
                </li>
                <li class="nav-tab" data-tab="about">
                    <i class="fas fa-info-circle"></i> Nosotros
                </li>
                <li class="nav-tab" data-tab="stats">
                    <i class="fas fa-chart-bar"></i> Estad√≠sticas
                </li>
                <li class="nav-tab" data-tab="team">
                    <i class="fas fa-users"></i> Equipo
                </li>
                <li class="nav-tab" data-tab="contact">
                    <i class="fas fa-envelope"></i> Contacto
                </li>
            </ul>
        </nav>

        <div class="admin-main">
            <div class="admin-content">
                <div class="alert success" id="successAlert">
                <i class="fas fa-check-circle"></i> Cambios guardados exitosamente
            </div>
            <div class="alert error" id="errorAlert">
                <i class="fas fa-exclamation-circle"></i> Error al guardar los cambios
            </div>

            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>Cargando...</p>
            </div>

            <!-- Tab Hero -->
            <div class="tab-content active" id="hero-tab">
                <div class="form-section">
                    <div class="form-section-header">
                        <h3><i class="fas fa-home"></i> Secci√≥n Principal</h3>
                    </div>
                    <div class="form-section-content">
                        <div class="form-group">
                            <label>T√≠tulo Principal</label>
                            <input type="text" class="form-control" id="hero-title" placeholder="Ej: Generamos, Creamos, Desarrollamos...">
                            <div class="form-help-text">Este ser√° el texto principal que ver√°n los visitantes al entrar a tu sitio</div>
                        </div>

                    <div class="form-group">
                        <label>Palabras Din√°micas (separadas por comas)</label>
                        <input type="text" class="form-control" id="hero-words" placeholder="leads, clientes, ventas, resultados, conversiones">
                        <div class="form-help-text">Estas palabras aparecer√°n rotando despu√©s del t√≠tulo principal</div>
                    </div>

                    <div class="form-group">
                        <label>Descripci√≥n del Servicio</label>
                        <textarea class="form-control" id="hero-description" placeholder="Describe brevemente qu√© haces y c√≥mo ayudas a tus clientes..."></textarea>
                        <div class="form-help-text">Explica de forma clara el valor que ofreces a tus clientes</div>
                    </div>

                    <div class="form-group">
                        <label>Texto Bot√≥n Principal</label>
                        <input type="text" class="form-control" id="hero-btn-primary" placeholder="Ej: Solicitar consulta gratuita">
                        <div class="form-help-text">Este es tu call-to-action principal - debe ser claro y atractivo</div>
                    </div>

                    <div class="form-group">
                        <label>Texto Bot√≥n Secundario</label>
                        <input type="text" class="form-control" id="hero-btn-secondary" placeholder="Ej: Ver casos de √©xito">
                        <div class="form-help-text">Acci√≥n alternativa para visitantes que quieren m√°s informaci√≥n</div>
                    </div>

                    <div class="form-group">
                        <label>Caracter√≠sticas</label>
                        <div class="dynamic-list" id="hero-features">
                        </div>
                        <button class="btn-add" onclick="addFeature()">
                            <i class="fas fa-plus"></i> Agregar Caracter√≠stica
                        </button>
                    </div>
                    </div>
                </div>
            </div>

            <!-- Tab About -->
            <div class="tab-content" id="about-tab">
                <div class="form-section">
                    <div class="form-section-header">
                        <h3><i class="fas fa-info-circle"></i> Secci√≥n Nosotros</h3>
                    </div>
                    <div class="form-section-content">
                        <div class="form-help-text" style="margin-bottom: 30px; border-left-color: #17a2b8;">
                            <strong>Secci√≥n "Acerca de nosotros":</strong> Aqu√≠ puedes explicar qui√©n eres, qu√© haces y c√≥mo ayudas a tus clientes. Esta informaci√≥n aparecer√° despu√©s de la secci√≥n principal.
                        </div>
                    
                        <div class="form-group">
                            <label>Etiqueta Superior</label>
                            <input type="text" class="form-control" id="about-label" placeholder="Ej: AGENCIA ESPECIALIZADA EN LEADS">
                            <div class="form-help-text">Texto peque√±o que aparece arriba del t√≠tulo de la secci√≥n</div>
                        </div>

                        <div class="form-group">
                            <label>T√≠tulo de la Secci√≥n</label>
                            <input type="text" class="form-control" id="about-title" placeholder="Ej: Soluciones de marketing para empresas">
                            <div class="form-help-text">T√≠tulo principal de la secci√≥n 'Nosotros'</div>
                        </div>

                    <div class="form-group">
                        <label>Servicios</label>
                        <div id="about-services">
                        </div>
                        <button class="btn-add" onclick="addService()">
                            <i class="fas fa-plus"></i> Agregar Servicio
                        </button>
                    </div>
                    </div>
                </div>
            </div>

            <!-- Tab Stats -->
            <div class="tab-content" id="stats-tab">
                <div class="form-section">
                    <div class="form-section-header">
                        <h3><i class="fas fa-chart-bar"></i> Estad√≠sticas</h3>
                    </div>
                    <div class="form-section-content">
                        <div class="form-help-text" style="margin-bottom: 30px; border-left-color: #ffc107;">
                            <strong>Estad√≠sticas de tu negocio:</strong> Muestra n√∫meros que generen confianza - clientes atendidos, a√±os de experiencia, satisfacci√≥n, etc. Estos datos aparecer√°n en tarjetas destacadas.
                        </div>
                    <div id="stats-list">
                    </div>
                    </div>
                </div>
            </div>

            <!-- Tab Team -->
            <div class="tab-content" id="team-tab">
                <div class="form-section">
                    <div class="form-section-header">
                        <h3><i class="fas fa-users"></i> Equipo</h3>
                    </div>
                    <div class="form-section-content">
                        <div class="form-help-text" style="margin-bottom: 30px; border-left-color: #28a745;">
                            <strong>Gesti√≥n del equipo:</strong> Agrega, edita o elimina miembros del equipo. Cada miembro puede tener nombre, cargo, imagen y descripci√≥n.
                        </div>

                        <div class="form-group">
                            <label>T√≠tulo de la Secci√≥n</label>
                            <input type="text" class="form-control" id="team-title" placeholder="Ej: Nuestro equipo de expertas">
                            <div class="form-help-text">T√≠tulo principal de la secci√≥n de equipo</div>
                        </div>

                        <div class="form-group">
                            <label>Descripci√≥n del Equipo</label>
                            <textarea class="form-control" id="team-description" placeholder="Describe brevemente el equipo..."></textarea>
                            <div class="form-help-text">Descripci√≥n que aparece debajo del t√≠tulo</div>
                        </div>

                        <div class="form-group">
                            <label>Miembros del Equipo</label>
                            <div id="team-members">
                                <!-- Los miembros se generar√°n din√°micamente -->
                            </div>
                            <button class="btn-add" onclick="addTeamMember()">
                                <i class="fas fa-plus"></i> Agregar Miembro
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tab Contact -->
            <div class="tab-content" id="contact-tab">
                <div class="form-section">
                    <div class="form-section-header">
                        <h3><i class="fas fa-envelope"></i> Informaci√≥n de Contacto</h3>
                    </div>
                    <div class="form-section-content">
                        <div class="form-help-text" style="margin-bottom: 30px; border-left-color: #dc3545;">
                            <strong>Canales de contacto:</strong> Configura c√≥mo los visitantes pueden comunicarse contigo. Esta informaci√≥n aparecer√° en el footer del sitio.
                        </div>
                    
                        <div class="form-group">
                            <label>Email de Contacto</label>
                            <input type="email" class="form-control" id="contact-email" placeholder="contacto@tuempresa.com">
                            <div class="form-help-text">Email principal donde los clientes pueden contactarte</div>
                        </div>

                        <div class="form-group">
                            <label>WhatsApp (solo n√∫meros)</label>
                            <input type="text" class="form-control" id="contact-whatsapp" placeholder="5491112345678">
                            <div class="form-help-text">N√∫mero completo con c√≥digo de pa√≠s, sin espacios ni signos</div>
                        </div>

                        <div class="form-group">
                            <label>LinkedIn URL</label>
                            <input type="url" class="form-control" id="contact-linkedin" placeholder="https://linkedin.com/company/tuempresa">
                            <div class="form-help-text">Link completo a tu perfil o p√°gina de empresa en LinkedIn</div>
                        </div>

                        <div class="form-group">
                            <label>Instagram URL</label>
                            <input type="url" class="form-control" id="contact-instagram" placeholder="https://instagram.com/tuempresa">
                            <div class="form-help-text">Link completo a tu cuenta de Instagram</div>
                        </div>
                    </div>
                </div>
            </div>

                <div class="admin-actions">
                    <button class="btn-save" onclick="saveChanges()">
                        <i class="fas fa-save"></i> Guardar Cambios
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Preview Modal -->
    <div class="preview-modal" id="previewModal">
        <div class="preview-modal-content">
            <div class="preview-modal-header">
                <h3><i class="fas fa-eye"></i> Vista Previa - Sitio Web Completo</h3>
                <div class="preview-modal-controls">
                    <button class="modal-btn" onclick="refreshModalPreview()">
                        <i class="fas fa-sync-alt"></i> Actualizar
                    </button>
                    <button class="modal-close-btn" onclick="closePreviewModal()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            <iframe id="previewModalFrame" src="index.html" class="preview-modal-iframe"></iframe>
        </div>
    </div>

    <script>
        let contentData = {};

        // Cargar datos al iniciar
        async function loadContent() {
            document.getElementById('loading').classList.add('active');
            try {
                const response = await fetch('/api/content');
                contentData = await response.json();
                populateForms();
            } catch (error) {
                console.error('Error cargando contenido:', error);
                showAlert('error', 'Error al cargar el contenido');
            } finally {
                document.getElementById('loading').classList.remove('active');
            }
        }

        // Llenar formularios con datos
        function populateForms() {
            // Hero
            document.getElementById('hero-title').value = contentData.hero?.title || '';
            document.getElementById('hero-words').value = contentData.hero?.dynamicWords?.join(', ') || '';
            document.getElementById('hero-description').value = contentData.hero?.description || '';
            document.getElementById('hero-btn-primary').value = contentData.hero?.primaryButton || '';
            document.getElementById('hero-btn-secondary').value = contentData.hero?.secondaryButton || '';
            
            // Features
            const featuresContainer = document.getElementById('hero-features');
            featuresContainer.innerHTML = '';
            contentData.hero?.features?.forEach(feature => {
                addFeature(feature);
            });

            // About
            document.getElementById('about-label').value = contentData.about?.label || '';
            document.getElementById('about-title').value = contentData.about?.title || '';
            
            // Services
            const servicesContainer = document.getElementById('about-services');
            servicesContainer.innerHTML = '';
            contentData.about?.services?.forEach(service => {
                addService(service);
            });

            // Stats
            const statsContainer = document.getElementById('stats-list');
            statsContainer.innerHTML = '';
            contentData.stats?.forEach(stat => {
                addStat(stat);
            });

            // (Team section removed - now using carousel)

            // Carrusel - cargar im√°genes configuradas o usar por defecto
            const defaultImages = [
                'assets/img/carrusel/1.jpg',
                'assets/img/carrusel/2.jpg',
                'assets/img/carrusel/3.png',
                'assets/img/carrusel/4.jpg',
                'assets/img/carrusel/5.jpg',
                'assets/img/carrusel/6.jpg',
                'assets/img/carrusel/7.jpg'
            ];

            // Migrar datos de team.members a carousel.images si existe
            let carouselImagesData = [];
            if (contentData.carousel?.images) {
                carouselImagesData = contentData.carousel.images;
            } else if (contentData.team?.members) {
                // Migrar desde la estructura antigua
                carouselImagesData = contentData.team.members.map(member => member.image || '');
                console.log('Migrating from team.members to carousel.images');
            }

            for (let i = 0; i < 7; i++) {
                const imgElement = document.getElementById(`carousel-${i + 1}`);
                if (imgElement) {
                    // Usar imagen configurada, migrada, o por defecto
                    const imageUrl = carouselImagesData[i] || defaultImages[i];
                    imgElement.value = imageUrl;

                    // Actualizar la vista previa de la imagen
                    const uploadElement = imgElement.closest('.image-upload');
                    if (uploadElement && imageUrl) {
                        uploadElement.innerHTML = `<img src="${imageUrl}" alt=""><input type="hidden" class="carousel-image" id="carousel-${i + 1}" value="${imageUrl}">`;
                    }
                }
            }

            // Team
            document.getElementById('team-title').value = contentData.team?.title || '';
            document.getElementById('team-description').value = contentData.team?.description || '';

            // Team Members
            const teamContainer = document.getElementById('team-members');
            teamContainer.innerHTML = '';
            if (contentData.team?.members && contentData.team.members.length > 0) {
                console.log('üìã Cargando', contentData.team.members.length, 'miembros del equipo');
                contentData.team.members.forEach((member, index) => {
                    console.log(`  ${index + 1}. ${member.name}: imagen="${member.image || 'SIN IMAGEN'}"`);
                    addTeamMember(member);
                });
            } else {
                // Add default team members if none exist
                console.log('üìã Agregando miembros por defecto');
                const defaultMembers = [
                    {
                        name: 'Valentina Pav√≥n',
                        role: 'Fundadora y L√≠der Comercial',
                        description: '',
                        image: 'assets/img/carrusel/valentina.jpg'
                    },
                    {
                        name: 'Luciana Carubin',
                        role: 'L√≠der de Marketing y Analista Comercial',
                        description: '',
                        image: 'assets/img/carrusel/luciana.jpg'
                    },
                    {
                        name: 'Victoria Pucci',
                        role: 'L√≠der de Finanzas',
                        description: '',
                        image: 'assets/img/carrusel/victoria.jpg'
                    },
                    {
                        name: 'Guadalupe Mir Marffini',
                        role: 'L√≠der de Operaciones',
                        description: '',
                        image: 'assets/img/carrusel/guadalupe.jpg'
                    },
                    {
                        name: 'Agustina Almada',
                        role: 'Trafficker Digital',
                        description: '',
                        image: 'assets/img/carrusel/agustina.jpg'
                    },
                    {
                        name: 'Dalma Alvarez',
                        role: 'Trafficker Digital',
                        description: '',
                        image: 'assets/img/carrusel/dalma.jpg'
                    },
                    {
                        name: 'Natalia Rojas',
                        role: 'Trafficker Digital',
                        description: '',
                        image: 'assets/img/carrusel/natalia.jpg'
                    }
                ];
                defaultMembers.forEach(member => {
                    addTeamMember(member);
                });
            }

            // Contact
            document.getElementById('contact-email').value = contentData.contact?.email || '';
            document.getElementById('contact-whatsapp').value = contentData.contact?.whatsapp || '';
            document.getElementById('contact-linkedin').value = contentData.contact?.linkedin || '';
            document.getElementById('contact-instagram').value = contentData.contact?.instagram || '';
        }

        // Funciones para agregar elementos din√°micos
        function addFeature(text = '') {
            const container = document.getElementById('hero-features');
            const div = document.createElement('div');
            div.className = 'dynamic-item';
            div.innerHTML = `
                <input type="text" class="form-control" value="${text}" placeholder="Nueva caracter√≠stica">
                <button class="btn-remove" onclick="this.parentElement.remove(); updatePreview();">
                    <i class="fas fa-trash"></i>
                </button>
            `;
            container.appendChild(div);
            
            // Agregar listener al nuevo input
            const newInput = div.querySelector('input');
            newInput.addEventListener('input', debounce(updatePreview, 300));
        }

        function addService(service = {}) {
            const container = document.getElementById('about-services');
            const div = document.createElement('div');
            div.className = 'form-section';
            div.style.background = 'white';
            div.innerHTML = `
                <div class="form-group">
                    <label>T√≠tulo del Servicio</label>
                    <input type="text" class="form-control service-title" value="${service.title || ''}" placeholder="Ej: Investigaci√≥n profunda del negocio">
                </div>
                <div class="form-group">
                    <label>Descripci√≥n</label>
                    <textarea class="form-control service-desc" placeholder="Describe qu√© incluye este servicio...">${service.description || ''}</textarea>
                </div>
                <button class="btn-remove" onclick="this.parentElement.remove(); updatePreview();">
                    <i class="fas fa-trash"></i> Eliminar Servicio
                </button>
            `;
            container.appendChild(div);
            
            // Agregar listeners a los nuevos inputs
            const newInputs = div.querySelectorAll('input, textarea');
            newInputs.forEach(input => {
                input.addEventListener('input', debounce(updatePreview, 300));
            });
        }

        function addStat(stat = {}) {
            const container = document.getElementById('stats-list');
            const div = document.createElement('div');
            div.className = 'dynamic-item';
            div.innerHTML = `
                <input type="text" class="form-control" value="${stat.value || ''}" placeholder="Valor (ej: 140+)">
                <input type="text" class="form-control" value="${stat.label || ''}" placeholder="Etiqueta (ej: Clientes atendidos)">
                <button class="btn-remove" onclick="this.parentElement.remove(); updatePreview();">
                    <i class="fas fa-trash"></i>
                </button>
            `;
            container.appendChild(div);
            
            // Agregar listeners a los nuevos inputs
            const newInputs = div.querySelectorAll('input');
            newInputs.forEach(input => {
                input.addEventListener('input', debounce(updatePreview, 300));
            });
        }

        function addTeamMember(member = {}) {
            console.log(`üÜï Agregando miembro: ${member.name}, imagen: "${member.image || 'SIN IMAGEN'}"`);
            const container = document.getElementById('team-members');
            const div = document.createElement('div');
            div.className = 'team-member-card';
            div.innerHTML = `
                <div class="form-group">
                    <label>Nombre</label>
                    <input type="text" class="form-control team-name" value="${member.name || ''}" placeholder="Nombre del miembro">
                </div>
                <div class="form-group">
                    <label>Cargo</label>
                    <input type="text" class="form-control team-role" value="${member.role || ''}" placeholder="Cargo o especialidad">
                </div>
                <div class="form-group">
                    <label>Descripci√≥n</label>
                    <textarea class="form-control team-description" placeholder="Descripci√≥n del miembro (opcional)">${member.description || ''}</textarea>
                </div>
                <div class="form-group">
                    <label>Imagen</label>
                    <div class="image-upload" onclick="selectImage(this)">
                        ${member.image ?
                            `<img src="${member.image}" alt="${member.name || 'Miembro'}">` :
                            `<div class="image-upload-placeholder">
                                <i class="fas fa-camera" style="font-size: 30px;"></i>
                                <p>Click para subir imagen</p>
                            </div>`
                        }
                        <input type="hidden" class="team-image" value="${member.image || ''}">
                    </div>
                </div>
                <button class="btn-remove" onclick="this.parentElement.remove(); updatePreview();" style="width: 100%; margin-top: 10px;">
                    <i class="fas fa-trash"></i> Eliminar Miembro
                </button>
            `;
            container.appendChild(div);

            // Verify the hidden input was set correctly
            const hiddenInput = div.querySelector('.team-image');
            console.log(`‚úÖ Input oculto para ${member.name}: "${hiddenInput.value}"`);

            // Agregar listeners a los nuevos inputs
            const newInputs = div.querySelectorAll('input, textarea');
            newInputs.forEach(input => {
                input.addEventListener('input', debounce(updatePreview, 300));
            });
        }


        // Guardar cambios
        async function saveChanges() {
            console.log('üíæ INICIANDO saveChanges()');

            // Recopilar datos del formulario
            const heroFeatures = Array.from(document.querySelectorAll('#hero-features input')).map(input => input.value).filter(v => v);
            
            const aboutServices = Array.from(document.querySelectorAll('#about-services .form-section')).map(section => ({
                title: section.querySelector('.service-title').value,
                description: section.querySelector('.service-desc').value
            }));

            const stats = Array.from(document.querySelectorAll('#stats-list .dynamic-item')).map(item => ({
                value: item.querySelectorAll('input')[0].value,
                label: item.querySelectorAll('input')[1].value
            }));

            // Recopilar datos del equipo
            const teamMembers = Array.from(document.querySelectorAll('#team-members .team-member-card')).map(card => ({
                name: card.querySelector('.team-name').value,
                role: card.querySelector('.team-role').value,
                description: card.querySelector('.team-description').value,
                image: card.querySelector('.team-image').value
            }));

            contentData = {
                hero: {
                    title: document.getElementById('hero-title').value,
                    dynamicWords: document.getElementById('hero-words').value.split(',').map(w => w.trim()),
                    description: document.getElementById('hero-description').value,
                    primaryButton: document.getElementById('hero-btn-primary').value,
                    secondaryButton: document.getElementById('hero-btn-secondary').value,
                    features: heroFeatures
                },
                about: {
                    label: document.getElementById('about-label').value,
                    title: document.getElementById('about-title').value,
                    services: aboutServices
                },
                stats: stats,
                team: {
                    title: document.getElementById('team-title').value,
                    description: document.getElementById('team-description').value,
                    members: teamMembers
                },
                contact: {
                    email: document.getElementById('contact-email').value,
                    whatsapp: document.getElementById('contact-whatsapp').value,
                    linkedin: document.getElementById('contact-linkedin').value,
                    instagram: document.getElementById('contact-instagram').value
                }
            };

            console.log('üì§ Enviando datos al servidor:', contentData);

            try {
                const response = await fetch('/api/content', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(contentData)
                });

                console.log('üì° Respuesta del servidor - Status:', response.status);

                if (response.ok) {
                    showAlert('success', 'Cambios guardados exitosamente');
                } else {
                    console.error('Error guardando cambios - HTTP:', response.status, response.statusText);
                    showAlert('error', 'Error al guardar los cambios en el servidor');
                }
            } catch (error) {
                console.error('Error guardando cambios - Exception:', error);
                showAlert('error', 'Error de conexi√≥n al guardar los cambios');
            }
        }

        // Navegaci√≥n por tabs
        document.querySelectorAll('.nav-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                // Remover active de todos
                document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                
                // Agregar active al seleccionado
                tab.classList.add('active');
                const tabId = tab.dataset.tab + '-tab';
                document.getElementById(tabId).classList.add('active');
            });
        });

        // Mostrar alertas
        function showAlert(type, message) {
            const alert = document.getElementById(type + 'Alert');
            alert.style.display = 'block';
            setTimeout(() => {
                alert.style.display = 'none';
            }, 3000);
        }

        // Subir imagen al servidor
        function selectImage(element) {
            console.log('üñºÔ∏è Iniciando selecci√≥n de imagen...');
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.onchange = async (e) => {
                const file = e.target.files[0];
                console.log('üìÅ Archivo seleccionado:', file ? file.name : 'ninguno');

                if (file) {
                    try {
                        console.log('üì§ Preparando subida de imagen...');
                        // Crear FormData para enviar la imagen
                        const formData = new FormData();
                        formData.append('image', file);

                        console.log('üåê Enviando petici√≥n a /api/upload...');
                        // Subir imagen al servidor
                        const response = await fetch('/api/upload', {
                            method: 'POST',
                            body: formData
                        });

                        console.log('üì° Respuesta recibida - Status:', response.status, response.statusText);

                        if (response.ok) {
                            console.log('‚úÖ Respuesta OK, parseando JSON...');
                            const result = await response.json();
                            console.log('üìä Resultado del servidor:', result);

                            // Actualizar la vista previa con la URL del servidor
                            console.log('üîÑ Actualizando DOM con nueva imagen...');

                            // Buscar el input ANTES de actualizar el innerHTML
                            const inputElement = element.querySelector('input');
                            console.log('üîç Input encontrado:', inputElement);

                            // Actualizar el contenido visual
                            element.innerHTML = `<img src="${result.url}" alt="">`;

                            // Crear un nuevo input oculto con la URL y la clase correcta
                            const newInput = document.createElement('input');
                            newInput.type = 'hidden';
                            newInput.className = 'team-image';
                            newInput.value = result.url;
                            element.appendChild(newInput);

                            console.log('‚úÖ DOM actualizado correctamente');
                            console.log('üîó Nuevo input creado con clase y valor:', newInput.className, newInput.value);

                            console.log('üîÑ Llamando a updatePreview()...');
                            // Actualizar preview inmediatamente
                            updatePreview();
                            console.log('‚úÖ updatePreview() completado');
                        } else {
                            console.error('‚ùå Error HTTP al subir imagen:', response.status, response.statusText);
                            const errorText = await response.text();
                            console.error('üìÑ Contenido del error:', errorText);
                            showAlert('error', 'Error al subir la imagen');
                        }
                    } catch (error) {
                        console.error('üí• Excepci√≥n al subir imagen:', error);
                        console.error('üìç Stack trace:', error.stack);
                        showAlert('error', 'Error al subir la imagen');
                    }
                }
            };
            input.click();
        }

        // Variables para preview
        let previewMode = 'desktop'; // 'desktop' or 'mobile'
        let previewData = {};

        // Funciones de preview
        function togglePreviewMode() {
            const previewContent = document.getElementById('previewContent');
            const icon = document.getElementById('previewModeIcon');
            const text = document.getElementById('previewModeText');
            
            if (previewMode === 'desktop') {
                previewMode = 'mobile';
                previewContent.classList.add('mobile-mode');
                icon.className = 'fas fa-desktop';
                text.textContent = 'Escritorio';
            } else {
                previewMode = 'desktop';
                previewContent.classList.remove('mobile-mode');
                icon.className = 'fas fa-mobile-alt';
                text.textContent = 'M√≥vil';
            }
        }

        function updatePreview() {
            console.log('üîÑ INICIO updatePreview()');
            // Recopilar datos actuales del formulario
            const heroFeatures = Array.from(document.querySelectorAll('#hero-features input')).map(input => input.value).filter(v => v);
            
            const aboutServices = Array.from(document.querySelectorAll('#about-services .form-section')).map(section => ({
                title: section.querySelector('.service-title')?.value || '',
                description: section.querySelector('.service-desc')?.value || ''
            }));

            const stats = Array.from(document.querySelectorAll('#stats-list .dynamic-item')).map(item => ({
                value: item.querySelectorAll('input')[0]?.value || '',
                label: item.querySelectorAll('input')[1]?.value || ''
            }));

            // Recopilar datos del equipo
            const teamMembers = Array.from(document.querySelectorAll('#team-members .team-member-card')).map((card, index) => {
                const imageInput = card.querySelector('.team-image');
                const imageValue = imageInput?.value || '';
                console.log(`üìä Recopilando datos - Miembro ${index + 1}: imagen="${imageValue}"`);

                return {
                    name: card.querySelector('.team-name')?.value || '',
                    role: card.querySelector('.team-role')?.value || '',
                    description: card.querySelector('.team-description')?.value || '',
                    image: imageValue
                };
            });

            previewData = {
                hero: {
                    title: document.getElementById('hero-title')?.value || '',
                    dynamicWords: document.getElementById('hero-words')?.value.split(',').map(w => w.trim()).filter(w => w) || [],
                    description: document.getElementById('hero-description')?.value || '',
                    primaryButton: document.getElementById('hero-btn-primary')?.value || '',
                    secondaryButton: document.getElementById('hero-btn-secondary')?.value || '',
                    features: heroFeatures
                },
                about: {
                    label: document.getElementById('about-label')?.value || '',
                    title: document.getElementById('about-title')?.value || '',
                    services: aboutServices
                },
                stats: stats,
                team: {
                    title: document.getElementById('team-title')?.value || '',
                    description: document.getElementById('team-description')?.value || '',
                    members: teamMembers
                },
                contact: {
                    email: document.getElementById('contact-email')?.value || '',
                    whatsapp: document.getElementById('contact-whatsapp')?.value || '',
                    linkedin: document.getElementById('contact-linkedin')?.value || '',
                    instagram: document.getElementById('contact-instagram')?.value || ''
                }
            };

            console.log('üìä Datos recopilados para preview:', previewData);

            // Enviar draft al servidor para vista previa
            console.log('üì§ Enviando draft al servidor...');
            sendDraftToServer(previewData);

            // Enviar datos al iframe de preview
            const previewFrame = document.getElementById('previewModalFrame');
            if (previewFrame && previewFrame.contentWindow) {
                console.log('üì∫ Enviando datos al iframe de preview...');
                previewFrame.contentWindow.postMessage({
                    type: 'updatePreview',
                    data: previewData
                }, '*');
            }
            console.log('‚úÖ FIN updatePreview()');
        }

        // Funci√≥n para enviar draft al servidor
        async function sendDraftToServer(data) {
            try {
                const response = await fetch('/api/content/draft', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                });

                if (!response.ok) {
                    console.error('Error al actualizar preview:', response.status, response.statusText);
                    // No mostrar alerta de error para drafts, solo loggear
                } else {
                    console.log('Preview actualizado correctamente');
                }
            } catch (error) {
                console.error('Error enviando draft para preview:', error);
                // No mostrar alerta de error para drafts, solo loggear
            }
        }

        function refreshPreview() {
            const previewFrame = document.getElementById('previewFrame');
            if (previewFrame) {
                previewFrame.src = previewFrame.src; // Recargar iframe
                setTimeout(updatePreview, 1000); // Actualizar despu√©s de recargar
            }
        }

        // Preview Modal Functions

        function openPreviewModal() {
            const modal = document.getElementById('previewModal');
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';

            // Primero actualizar el draft en el servidor
            updatePreview();

            // Luego cargar el iframe con modo preview
            const modalFrame = document.getElementById('previewModalFrame');
            if (modalFrame) {
                const timestamp = Date.now();
                modalFrame.src = `index.html?preview=true&t=${timestamp}`;

                // Wait for iframe to load and then send data directly
                modalFrame.onload = function() {
                    setTimeout(() => {
                        try {
                            modalFrame.contentWindow.postMessage({
                                type: 'updatePreview',
                                data: previewData
                            }, '*');
                            console.log('üì± Datos enviados al iframe:', previewData.team);
                        } catch (e) {
                            console.error('Error enviando datos al iframe:', e);
                        }
                    }, 500);
                };
            }
        }

        function closePreviewModal() {
            const modal = document.getElementById('previewModal');
            modal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        function refreshModalPreview() {
            const modalFrame = document.getElementById('previewModalFrame');
            if (modalFrame) {
                // Recargar el iframe con el contenido draft
                modalFrame.src = 'index.html?preview=true&t=' + Date.now();
                setTimeout(() => {
                    updatePreview();
                }, 500);
            }
        }


        // Cerrar modal con Escape
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closePreviewModal();
            }
        });

        // Cerrar modal haciendo click fuera
        document.getElementById('previewModal').addEventListener('click', (e) => {
            if (e.target.classList.contains('preview-modal')) {
                closePreviewModal();
            }
        });

        function renderPreview() {
            const previewContainer = document.getElementById('previewContent');
            
            // Render Hero Section with exact landing structure
            const heroHtml = `
                <div class="preview-section">
                    <div class="section-label">SECCI√ìN PRINCIPAL</div>
                    <div class="preview-hero">
                        <div class="preview-hero-content">
                            <div class="preview-hero-text">
                                <h1>${previewData.hero.title}<br><span class="dynamic-text">${previewData.hero.dynamicWords[0] || 'leads'}</span></h1>
                                <p>${previewData.hero.description}</p>
                                <div class="preview-hero-buttons">
                                    <button class="preview-btn-primary">${previewData.hero.primaryButton}</button>
                                    <button class="preview-btn-secondary">${previewData.hero.secondaryButton}</button>
                                </div>
                                <div class="preview-hero-features">
                                    ${previewData.hero.features.map(feature => `
                                        <div class="preview-feature">
                                            <i class="fas fa-check-circle"></i>
                                            <span>${feature}</span>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                            <div class="preview-hero-image">
                                <div style="background: rgba(255,255,255,0.1); border-radius: 20px; padding: 2rem; text-align: center;">
                                    <div style="color: white; font-weight: 600;">Vista previa del hero</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // Render About Section with exact landing structure
            const aboutHtml = `
                <div class="preview-section">
                    <div class="section-label">SECCI√ìN NOSOTROS</div>
                    <div class="preview-about">
                        <div class="preview-about-content">
                            <div class="preview-about-image">
                                <div style="background: #f0f0f0; border-radius: 20px; padding: 3rem; text-align: center; color: #666;">
                                    Imagen de la secci√≥n
                                </div>
                            </div>
                            <div class="preview-about-text">
                                <span class="preview-section-label">${previewData.about.label}</span>
                                <h2>${previewData.about.title}</h2>
                                ${previewData.about.services.map((service, index) => `
                                    <div class="preview-service-item">
                                        <div class="preview-service-icon">
                                            <i class="fas ${index === 0 ? 'fa-search' : 'fa-bullseye'}"></i>
                                        </div>
                                        <div class="preview-service-content">
                                            <h4>${service.title}</h4>
                                            <p>${service.description}</p>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // Render Stats Section with exact landing structure
            const statsHtml = `
                <div class="preview-section">
                    <div class="section-label">ESTAD√çSTICAS</div>
                    <div class="preview-stats">
                        <div class="preview-stats-content">
                            <h2>Resultados que hablan por s√≠ solos</h2>
                            <div class="preview-stats-grid">
                                ${previewData.stats.map(stat => `
                                    <div class="preview-stat-item">
                                        <div class="preview-stat-value">${stat.value}</div>
                                        <div class="preview-stat-label">${stat.label}</div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // Render Team Section (Dynamic)
            let teamHtml = '';

            if (previewData.team && previewData.team.members && previewData.team.members.length > 0) {
                console.log('üé† Renderizando equipo en preview:', previewData.team.members);

                teamHtml = `
                    <div class="preview-section">
                        <div class="section-label">EQUIPO</div>
                        <div class="preview-team">
                            <div class="preview-team-content">
                                <h2>${previewData.team.title || 'Nuestro equipo'}</h2>
                                <p style="margin-bottom: 2rem; color: #666;">${previewData.team.description || ''}</p>
                                <div class="preview-team-grid">
                                    ${previewData.team.members.map(member => {
                                        // Ensure full URL for images in preview
                                        let imageUrl = member.image || '';
                                        if (imageUrl && !imageUrl.startsWith('http') && !imageUrl.startsWith('data:')) {
                                            imageUrl = window.location.origin + '/' + imageUrl.replace(/^\/+/, '');
                                        }
                                        console.log(`üñºÔ∏è Preview image for ${member.name}:`, imageUrl);

                                        const fallbackSVG = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIwIiBoZWlnaHQ9IjEyMCIgdmlld0JveD0iMCAwIDEyMCAxMjAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxMjAiIGhlaWdodD0iMTIwIiBmaWxsPSIjRjNGNEY2Ii8+CjxjaXJjbGUgY3g9IjYwIiBjeT0iNTAiIHI9IjIwIiBmaWxsPSIjRDBENURBIi8+CjxwYXRoIGQ9Ik02MCA4MEM0Ny41IDgwIDM3IDcwLjUgMzcgNzlIMTAzQzEwMyA3MC41IDkyLjUgODAgNjAgODBaIiBmaWxsPSIjRDBENURBIi8+Cjwvc3ZnPgo=';

                                        return `
                                            <div class="preview-team-member">
                                                <img src="${imageUrl || fallbackSVG}" alt="${member.name}" class="preview-team-avatar" onerror="console.error('Preview image failed for ${member.name}:', this.src); this.src='${fallbackSVG}';" onload="console.log('Preview image loaded for ${member.name}')">
                                                <div class="preview-team-name">${member.name}</div>
                                                <div class="preview-team-role">${member.role}</div>
                                                ${member.description ? `<p style="font-size: 0.9rem; margin-top: 0.5rem; color: #666; font-style: italic;">${member.description}</p>` : ''}
                                            </div>
                                        `;
                                    }).join('')}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            } else {
                teamHtml = `
                    <div class="preview-section">
                        <div class="section-label">EQUIPO</div>
                        <div class="preview-team">
                            <div class="preview-team-content">
                                <h2>Agregar miembros del equipo</h2>
                                <p style="color: #666; font-style: italic;">Ve a la secci√≥n "Equipo" para agregar miembros</p>
                            </div>
                        </div>
                    </div>
                `;
            }

            previewContainer.innerHTML = heroHtml + aboutHtml + statsHtml + teamHtml;
        }

        // Event listeners para actualizaci√≥n en tiempo real
        function addPreviewListeners() {
            // Inputs de texto
            document.querySelectorAll('input[type="text"], input[type="email"], input[type="url"], textarea').forEach(input => {
                if (!input.hasAttribute('data-preview-listener')) {
                    input.setAttribute('data-preview-listener', 'true');
                    input.addEventListener('input', debounce(updatePreview, 300));
                }
            });
        }

        // Debounce function para evitar actualizaciones muy frecuentes
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }


        // Agregar stats autom√°ticamente si no hay ninguna
        function addDefaultStats() {
            const statsContainer = document.getElementById('stats-list');
            if (statsContainer.children.length === 0) {
                // Agregar estad√≠sticas por defecto
                addStat({ value: '140+', label: 'Clientes atendidos' });
                addStat({ value: '4.5/5', label: 'Satisfacci√≥n promedio' });
                addStat({ value: '7', label: 'Expertas en el equipo' });
                addStat({ value: '100%', label: 'Enfoque en conversi√≥n' });
            }
        }

        // Agregar bot√≥n para agregar estad√≠sticas
        function addStatsButton() {
            const statsContainer = document.getElementById('stats-list');
            if (!document.getElementById('add-stat-btn')) {
                const addButton = document.createElement('button');
                addButton.id = 'add-stat-btn';
                addButton.className = 'btn-add';
                addButton.innerHTML = '<i class="fas fa-plus"></i> Agregar Estad√≠stica';
                addButton.onclick = () => addStat();
                statsContainer.parentNode.appendChild(addButton);
            }
        }


        // Modificar la funci√≥n de carga para inicializar preview
        async function loadContentWithPreview() {
            await loadContent();
            addDefaultStats();
            addStatsButton();
            addPreviewListeners();
            updatePreview();
        }

        // Cargar contenido al iniciar
        loadContentWithPreview();
    </script>
</body>
</html>